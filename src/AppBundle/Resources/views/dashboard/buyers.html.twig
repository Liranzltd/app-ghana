{% extends "AppBundle::standard_layout.html.twig" %}

{% block stylesheets %}
  {{ parent() }}
  <link rel="stylesheet" href="{{ asset('bundles/app/css/dataTables.bootstrap.css') }}">
{% endblock %}

{% block content %}
<h1 class="dasheader">
  APP Control panel
  <small> - Buyer Dashboard</small>
</h1>

<div class="row">
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-aqua">
      <div class="inner">
        <h3>{{ registered_buyers|length + new_buyers|length + unverified|length }}</h3>
        <p>Total Buyers</p>
      </div>
      <div class="icon">
        <i class="ion ion-bag"></i>
      </div>
      <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-green">
      <div class="inner">
        <h3>{{ new_buyers|length }}</h3>
        <p>New Applications</p>
      </div>
      <div class="icon">
        <i class="ion ion-stats-bars"></i>
      </div>
      <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-yellow">
      <div class="inner">
        <h3>{{unverified|length}}</h3>
        <p>Under Review</p>
      </div>
      <div class="icon">
        <i class="ion ion-person-add"></i>
      </div>
      <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-red">
      <div class="inner">
        <h3>{{registered_buyers|length}}</h3>
        <p>Verified</p>
      </div>
      <div class="icon">
        <i class="ion ion-pie-graph"></i>
      </div>
      <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
</div>
<div class="row">
  <div class="col-lg-12">
    <div class="box">
      <div class="box-header">
        <h3 class="box-title">Registered Buyers</h3>
      </div>
      <!-- /.box-header -->
      <div class="box-body">
        <table id="verifications" class="table table-bordered table-striped datatables">
          <thead>
            <tr>
              <th>Company</th>
              <th>APP Registration Date</th>
              <th>Tenders Posted</th>
              <th>Last SourceDogg Login</th>
            </tr>
          </thead>
          <tbody>
            {% for company in unverified %}
            <tr>
              <td><a href="{{ path('admin_app_company_edit',{id: company.id }) }}">{{ company.name }}</a></td>
              <td>{{ company.createdAt|date('d/m/Y') }}</td>
              <td>{{ company.postedRequests|length }}</td>
              <td>&nbsp;</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="box">
      <div class="box-header">
        <h3 class="box-title">New Applications</h3>
      </div>
      <!-- /.box-header -->
      <div class="box-body">
        <table id="verifications" class="table table-bordered table-striped datatables">
          <thead>
            <tr>
              <th>Company</th>
              <th>APP Registration Date</th>
            </tr>
          </thead>
          <tbody>
            {% for company in new_buyers %}
            <tr>
              <td><a href="{{ path('admin_app_company_edit',{id: company.id }) }}">{{ company.name }}</a></td>
              <td>{{ company.createdAt|date('d/m/Y') }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="box">
      <div class="box-header">
        <h3 class="box-title">Under Review</h3>
      </div>
      <!-- /.box-header -->
      <div class="box-body">
        <table id="verifications" class="table table-bordered table-striped datatables">
          <thead>
            <tr>
              <th>Company</th>
              <th>APP Registration Date</th>
            </tr>
          </thead>
          <tbody>
            {% for company in unverified %}
            <tr>
              <td><a href="{{ path('admin_app_company_edit',{id: company.id }) }}">{{ company.name }}</a></td>
              <td>{{ company.createdAt|date('d/m/Y') }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block javascripts %}
  {{ parent() }}
  <script type="text/javascript" src="{{asset('bundles/app/js/datatables.min.js')}}"></script>
  <script type="text/javascript" src="{{asset('bundles/app/js/dataTables.bootstrap.min.js')}}"></script>
  <script>
    $(function() {
      $('.datatables').DataTable({
        "paging": true,
        "lengthChange": false,
        "searching": true,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "language": {
          "emptyTable": $(this).data('empty')
        }
      });
    });
  </script>
{% endblock %}
