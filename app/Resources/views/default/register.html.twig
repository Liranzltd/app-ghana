{% extends 'base-bannerless.html.twig' %}

{% block body %}
<div class="container">
  <div class="row">
    <div class="col-lg-12">
      <h3>Welcome to the APP</h3>
      <p>The African Partner Pool allows you to quickly identify companies capable of delivering the products and services you need to the standards you require. The APP is also used by a host of companies looking to locate businesses like yours to supply the products and services they need.</p>
    </div>
    <div class="col-lg-12">
      <form action="/user/register" method="post" id="register" no-validate>
        <div class="row">
          <div class="col-lg-6">
            <div class="form-group">
              <label for="name">Name*</label>
              <input type="text" name="firstname" required>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="form-group">
              <label for="name">Surname*</label>
              <input type="text" name="surname" required>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-6">
            <div class="form-group">
              <label for="name">Gender*</label>
              <select name="gender" id="selectbox" required>
                <option value="">Select One</option>
                <option value="Female">Female</option>
                <option value="Male">Male</option>
              </select>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="form-group">
              <label>Email*</label>
              <input type="email" name="email" id="email" required>
              <small id="emailHelp" class="form-text text-muted invalid"></small>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-6">
            <div class="form-group">
              <label>Telephone number*</label>
              <input type="text" name="phone" id="phone" required>
              <input type="hidden" name="mobile" />
              <small id="phoneHelp" class="form-text text-muted invalid"></small>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="form-group">
              <label>Account Type*</label>
              <select name="accountType" id="accountType" required>
                <option value="">Select One</option>
                <option value="Supplier">Supplier</option>
                <option value="Buyer">Buyer</option>
              </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="form-group">
              <label>Name of Company*</label><input type="text" id="company" name="company" required>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-6">
            <div class="form-group">
              <label>TIN*</label>
              <input type="text" name="graTinNumber" id="graTinNumber" required>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="form-group">
              <label>Company registration type*</label>
              <select name="companyType" id="companyType" required>
                <option value="">Select One</option>
                {% for type in company_types %}
                  <option value="{{ type.id }}">{{ type.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-4">
            <div class="form-group">
              <label>Company Registration Date*</label>
              <div class='input-group' id='registrationDatePicker'>
                  <input type='text' class="form-control" name="registrationDate" id="registrationDate" required pattern="^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$" />
                  <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                  </span>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="form-group">
              <label>Sector*</label>
              <select name="sector" id="sector" required>
                <option value="">Select One</option>
                {% for category in categories %}
                  <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="form-group">
              <label>Position or role in company*</label>
              <input type="text" name="role" id="role" required>
            </div>
          </div>
        </div>
        {# Added by David Ajowi 09-10-2019 #}
        <div class="row">
          <div class="col-lg-4">
            <div class="form-group">
              <label>Percentage of Shares Owned by a Woman/Women*</label>
                <select name="womanOwnershipPercentage" id="womanOwnershipPercentage" required>
                  <option value="">Select One</option>
                  <option value="0%">0%</option>
                  <option value="1-50%">1-50%</option>
                  <option value="51-100%">51-100%</option>
                </select>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="form-group">
              <label>Are Any of Your Ownership Below 35 Years of Age*</label>
                <select name="ownershipUnder30" id="ownershipUnder30" required>
                  <option value="">Select One</option>
                    <option value="1">Yes</option>
                    <option value="0">No</option>
                </select>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="form-group">
              <label>Approximate Turnover*</label>
                <select name="approxTurnover" id="approxTurnover" required>
                  <option value="">Select One</option>
                  <option value="Below 500,000 GHS">Below 500,000 GHS</option>
                  <option value="500,000 – 1 million GHS">500,000 – 1 million GHS</option>
                  <option value="1 million - 5 million GHS">1 million - 5 million GHS</option>
                  <option value="5 million - 25 million GHS">5 million - 25 million GHS</option>
                  <option value="25 million - 50 million GHS">25 million - 50 million GHS</option>
                  <option value="50 million - 100 million GHS">50 million - 100 million GHS</option>
                  <option value="100 million - 250 million GHS">100 million - 250 million GHS</option>
                  <option value="250 million - 500 million GHS">250 million - 500 million GHS</option>
                </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
             <div class="g-recaptcha" data-sitekey="6LfWLdgUAAAAADtoJTjD73C-nykk0oAewhBxs7Nx"></div>
           </div> 
        </div>
        <div class="row">
          <div class="col-xs-12">
             By clicking <strong class="label label-primary">Register</strong>, you agree to the <a href="/terms" target="_blank" style="color:blue">Terms and Conditions</a> set out by this site, including our Cookie Use.
          </div>
        </div>
        {# END Added by David Ajowi 09-10-2019 #}
        <div class="row">
          <input id="tier" name="tier" type="hidden" value="{{ tier }}" />
          <div class="col-lg-12"><button type="submit" class="btn mb20 btn-medium btn-transparent-primary pull-right" style="border: 2px solid grey;">Register </button></div>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  {% javascripts '@AppBundle/Resources/public/js/intlTelInput.js' '@AppBundle/Resources/public/js/defaultCountryIp.js' '@AppBundle/Resources/public/js/jquery-ui.js' '@AppBundle/Resources/public/js/jquery.ui.widget.js' '@AppBundle/Resources/public/js/moment.min.js' '@AppBundle/Resources/public/js/bootstrap-datetimepicker.js' '@AppBundle/Resources/public/js/parsley.min.js' filter='?jsqueeze' %}
      <script src="{{ asset_url }}"></script>
  {% endjavascripts %}

  <script>
    $(function ()
    {
      $('#register').parsley();
      $('#registrationDate').datetimepicker({
          viewMode: "years",
          format: 'DD/MM/YYYY',
          keepOpen: true,
      });

      $('#registrationDate').on("dp.change",function (e) {
        $(this).parsley().removeError('pattern');
        $(this).parsley().removeError('required');
      });

      $("#company" ).autocomplete({
        source: '{{ path('check-company') }}',
        minLength: 2
      });

      $('#phone').on('focusout',function()
      {
        var input = $('#phone');
        if(input.intlTelInput("getNumber"))
        {
          if(input.intlTelInput("isValidNumber"))
          {
            input.closest('.form-group').removeClass('has-error');
            $('.mobile').text(input.data('label'));
            checkRegistered('mobile',input.intlTelInput("getNumber"));
            $('input[name="mobile"]').val(input.intlTelInput("getNumber"));
          }
          else
          {
            $('#mobile').closest('.form-group').addClass('has-error');
            $('.mobile').text('Invalid mobile number');
          }
        }
      });
      $('#email').on('focusout',function()
      {
        if($('#email').val())
        {
          checkRegistered('email',$('#email').val());
        }
      });

      $('#promocodecheck').on('click',function()
      {
        if($('#promocode').val())
        {
          checkRegistered('promocode',$('#promocode').val());
        }
      });

      function checkRegistered(field,value)
      {
        $.ajax({
          url: '{{ path('validate-info') }}',
          data: { field: field, value: value },
          success:  function(response)
          {
            if(response.status == 'exists')
            {
              //$('#'+field).addClass('has-error');
              $('#'+field+'Help').html(response.message);
              //console.log($('#'+field+'Help'));
            }
            else
            {
              // $('#'+field).closest('.col-lg-*').removeClass('has-error');
              $('#'+field+'Help').html('');
            }
          }
        });
      }

    });
    $('#accountType').on('change',function()
    {
      if($(this).val() == 'Supplier')
      {
        $('#membershipCategoryRow').removeClass('hidden');
      }
      else
      {
        $('#membershipCategoryRow').addClass('hidden');
      }
    });

  </script>
  <script src='https://www.google.com/recaptcha/api.js'></script>
{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <link rel="stylesheet" href="{{ asset('bundles/sonatacore/vendor/bootstrap/dist/css/bootstrap.min.css')}}">
  <link rel="stylesheet" href="{{ asset('bundles/app/css/intlTelInput.css')}}">
  <link rel="stylesheet" href="{{ asset('bundles/app/css/jquery-ui.css')}}">
  <link rel="stylesheet" href="{{ asset('bundles/app/css/rfi.css')}}">
  <link rel="stylesheet" href="{{ asset('bundles/sonatacore/vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css')}}">
  <style>
    .bootstrap-datetimepicker-widget table th.dow {
      color: #FFF;
    }
    .bootstrap-datetimepicker-widget table td.active > div, .bootstrap-datetimepicker-widget table td.active:hover > div {
      background-color: #428bca;
      color: #FFFFFF;
    }
    .bootstrap-datetimepicker-widget td, .bootstrap-datetimepicker-widget th, .bootstrap-datetimepicker-widget .picker-switch, .bootstrap-datetimepicker-widget table td span {
      border-radius: 0px;
    }
    .bootstrap-datetimepicker-widget table td span {
      width: 54px;
      height: 54px;
      line-height: 54px;
      margin: 2px 1.5px;
    }
    .table-condensed>tbody>tr>td {
        padding: 1px;
    }
  </style>
{% endblock %}
